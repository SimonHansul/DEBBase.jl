<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia · DEBBase.jl</title><meta name="title" content="DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia · DEBBase.jl"/><meta property="og:title" content="DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia · DEBBase.jl"/><meta property="twitter:title" content="DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia · DEBBase.jl"/><meta name="description" content="Documentation for DEBBase.jl."/><meta property="og:description" content="Documentation for DEBBase.jl."/><meta property="twitter:description" content="Documentation for DEBBase.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>DEBBase.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia</a><ul class="internal"><li><a class="tocitem" href="#DEBODE:-DEB-TKTD-model-as-system-of-ordinary-differential-equations"><span>DEBODE: DEB-TKTD model as system of ordinary differential equations</span></a></li><li><a class="tocitem" href="#ABC:-Parameter-inference-using-Sequential-Monte-Carlo-Approximate-Bayesian-Computation"><span>ABC: Parameter inference using Sequential Monte Carlo Approximate Bayesian Computation</span></a></li><li><a class="tocitem" href="#DoseResponse:-A-collection-of-Dose-Response-functions"><span>DoseResponse: A collection of Dose-Response functions</span></a></li><li><a class="tocitem" href="#Figures:-Recipes-and-utilities-for-plotting-model-output"><span>Figures: Recipes and utilities for plotting model output</span></a></li><li><a class="tocitem" href="#ParamStructs:-Infrastructure-to-organize-parameter-structures"><span>ParamStructs: Infrastructure to organize parameter structures</span></a></li><li><a class="tocitem" href="#Utils:-Other-utility-functions"><span>Utils: Other utility functions</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SimonHansul/DEBBase.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SimonHansul/DEBBase.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="DEBBase.jl:-A-basis-for-Dynamic-Energy-Budget-modelling-in-Julia"><a class="docs-heading-anchor" href="#DEBBase.jl:-A-basis-for-Dynamic-Energy-Budget-modelling-in-Julia">DEBBase.jl: A basis for Dynamic Energy Budget modelling in Julia</a><a id="DEBBase.jl:-A-basis-for-Dynamic-Energy-Budget-modelling-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#DEBBase.jl:-A-basis-for-Dynamic-Energy-Budget-modelling-in-Julia" title="Permalink"></a></h1><p>DEBBase includes a number of submodules. </p><p>The core of the package is formed by <code>DEBBase.DEBODE</code> and <code>DEBBase.ABC</code>.</p><p><code>DEBODE</code> defines a baseline DEB-TKTD model and provides the core functionality to run simulations.  <code>ABC</code> contains code for parameter estimation using Sequential Monte Carlo Approximate Bayesian Computation. </p><h2 id="DEBODE:-DEB-TKTD-model-as-system-of-ordinary-differential-equations"><a class="docs-heading-anchor" href="#DEBODE:-DEB-TKTD-model-as-system-of-ordinary-differential-equations">DEBODE: DEB-TKTD model as system of ordinary differential equations</a><a id="DEBODE:-DEB-TKTD-model-as-system-of-ordinary-differential-equations-1"></a><a class="docs-heading-anchor-permalink" href="#DEBODE:-DEB-TKTD-model-as-system-of-ordinary-differential-equations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.DEBParamCollection" href="#DEBBase.DEBODE.DEBParamCollection"><code>DEBBase.DEBODE.DEBParamCollection</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>A <code>DEBParamCollection</code> contains global parameters <code>glb</code> and spc parameters <code>spc</code> (including TKTD-parameters). <br/>Initialize the default parameter collection with <code>DEBParamCollection()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/paramstructs.jl#L109-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.GlobalParams" href="#DEBBase.DEBODE.GlobalParams"><code>DEBBase.DEBODE.GlobalParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>GlobalParams</code> contain the global parameters (simulated timespan <code>t_max</code>, nutrient influx rate <code>Xdot_in</code>, etc.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/paramstructs.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.ODEAgentParams" href="#DEBBase.DEBODE.ODEAgentParams"><code>DEBBase.DEBODE.ODEAgentParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ODEAgentParams(spc::AbstractParams)</code></pre><p>ODEAgentParams are subject to agent variability.  This is in contrast to SpeciesParams, which define parameters on the species-level.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/paramstructs.jl#L86-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.SpeciesParams" href="#DEBBase.DEBODE.SpeciesParams"><code>DEBBase.DEBODE.SpeciesParams</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p><code>SpeciesParams</code> contain population means of DEB and TKTD parameters.  Default values are roughly reproduce life-history of Daphnia minda (model currency mass carbon in μgC) exposued to Azoxystrobin (mg/L). <br/>DEBBase.jl uses a hierarchical modelling approach where the <code>SpeciesParams</code> are  parameters which are common across all agents of a species,  and <code>ODEAgentParams</code> contain parameters which are specific for an individual. <br/>Variability is given by the zoom factor <code>Z::Distribution</code>, which is always applied to the surface-area specific ingestion rates  and can optionally propagate to parameters indicated in <code>propagate_zoom::NTuple</code>. <br/><code>Z</code> is <code>Dirac(1)</code> by default, i.e. there is no agent variability in the default parameters. <br/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/paramstructs.jl#L13-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.DEBODE_DA!-NTuple{4, Any}" href="#DEBBase.DEBODE.DEBODE_DA!-NTuple{4, Any}"><code>DEBBase.DEBODE.DEBODE_DA!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DEBODE_DA!()</code></pre><p>Base model assuming Damage Addition (DA) for mixture toxicity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L540-L544">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.DEBODE_IA!-NTuple{4, Any}" href="#DEBBase.DEBODE.DEBODE_IA!-NTuple{4, Any}"><code>DEBBase.DEBODE.DEBODE_IA!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DEBODE_IA!(du, u, p, t)</code></pre><p>Definition of base model as a system of ordinary differential equations.  This model definition is suitable for simulating the life-history of a single organism in conjecture with OrdinaryDiffEq/DifferentialEquations.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L506-L511">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.Hbj-NTuple{6, Float64}" href="#DEBBase.DEBODE.Hbj-NTuple{6, Float64}"><code>DEBBase.DEBODE.Hbj</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Mautrity-driven metabolic acceleration from birth to maturity threshold <code>H_j</code> (metamorphosis).  We assume that some baseline parameter <code>p</code> has value <code>p_b</code> at birth and <code>p_j</code> at metamorphosis. Between birth and metamorphosis, the current value of <code>p</code> is the maturity-weighted mean of <code>p_b</code> and <code>p_j</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L482-L486">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.Sdot_negative-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.Sdot_negative-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.Sdot_negative</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Negative somatic growth</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L163-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.Sdot_positive-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.Sdot_positive-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.Sdot_positive</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Positive somatic growth</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L150-L152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.calc_SL_max-Tuple{DEBBase.ParamStructs.AbstractSpeciesParams}" href="#DEBBase.DEBODE.calc_SL_max-Tuple{DEBBase.ParamStructs.AbstractSpeciesParams}"><code>DEBBase.DEBODE.calc_SL_max</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_SL_max(spc::AbstractSpeciesParams)::Float64</code></pre><p>Calculate maximum structural length <span>$slmax$</span>, given in dimension <span>$m^(1/3)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/traits.jl#L1-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.calc_S_max-Tuple{DEBBase.ParamStructs.AbstractSpeciesParams}" href="#DEBBase.DEBODE.calc_S_max-Tuple{DEBBase.ParamStructs.AbstractSpeciesParams}"><code>DEBBase.DEBODE.calc_S_max</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_S_max(spc::AbstractParams)::Float64</code></pre><p>Calculate maximum structural mass smax [m]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/traits.jl#L9-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.clipneg-Tuple{Float64}" href="#DEBBase.DEBODE.clipneg-Tuple{Float64}"><code>DEBBase.DEBODE.clipneg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Clip negative values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dA!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dA!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dA!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assimilation flux</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L106-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dC_W!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dC_W!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dC_W!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dC_W!(
    du::ComponentVector,
    u::ComponentVector,
    p::AbstractParamCollection,
    t::Real
    )::Nothing</code></pre><p>Change in external concentrations.  Currently simply returns zeros because time-variable exposure is not yet implemented. </p><p><strong>TODO: extend to account for time-variable exposure.</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L342-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dD!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dD!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dD!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>TK for spc-TKTD model, including effect of surface area to volume ratio and dilution by growth.  If <code>D</code> and is given as a Vector, TK is only stressor-specific but not PMoA-specific. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L382-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dH!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dH!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dH!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Maturation flux. </p><p>Maturity is dissipated energy and can therefore not be burned to cover maintenance costs. </p><p>Currently there are no consequences for an organism not covering maturity maintenance.  If this turns out to be an issue, we might consider to add a damage pool <span>$D_H$</span>, where the amount of maturity maintenance that could not be covered is accumulated.  This might then lead to a fitness penalty depending on <span>$D_H$</span>, for example in the form of additional  mortality or embryonic hazard. </p><p>Such rules are however likely species-specific and should be evaluated in the light of a more precise problem definition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L239-L251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dH_b!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dH_b!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dH_b!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Update the current estimate of H<em>b.  The current estimate of maturity at birth is equal to current maturity for embryos,  and will be fixed to the current value upon completion of embryonic development. This way, we obtain H</em>b as an implied trait and can use it later (for example in <code>abj()</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L269-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dI!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dI!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dI!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dI!(
    du::ComponentArray,
    u::ComponentArray,
    p::AbstractParamCollection,
    t::Real
    )::Nothing</code></pre><p>Calculate ingestion rate.  Embryos (<code>X_emb &lt;= 0</code>) take up resources from the vitellus <code>X_emb</code>.  Juveniles and adults (<code>X_emb &gt; 0</code>) feed on the external resource <code>X_p</code>. </p><p>The DEBBase model assumes that all state variables are given as mass (or a linearly proportional quantity).  As this includes structure, the ingestion rate scales with the structural mass <span>$S^{2/3}$</span>`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L56-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dJ!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dJ!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dJ!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Maturity maintenance flux</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L134-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dM!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dM!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dM!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Somatic maintenance flux</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L120-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dQ!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dQ!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dQ!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dQ!(
    du::ComponentArray,
    u::ComponentArray,
    p::AbstractParamCollection,
    t::Real
    )::Nothing</code></pre><p>Calculation of the total dissipation flux, equal to the sum of maintenance costs and overheads paid for assimilation, mobilization, maturation, growth and reproduction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L312-L321">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dR!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dR!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dR!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reproduction flux.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L292-L294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dS!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dS!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dS!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Somatic growth, including application of shrinking equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L191-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dS_max_hist!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dS_max_hist!-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dS_max_hist!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dS_max_hist!(
    du::ComponentArray,
    u::ComponentArray,
    p::AbstractParamCollection,
    t::Real
    )::Nothing</code></pre><p>Reference structure <code>S_max_hist</code>, which is used as a measure of energetic state.</p><p>This is the amount of structure an individual of the given age has under ideal conditions,  i.e. <code>f = 1</code> and <code>y_z = 1</code>, with the exception of <code>y_G</code>.  Values of <code>y_G != 1</code> are included in the calculation of <code>S_max_hist</code>, so that a slowing down of growth </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L206-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.dX_p!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.dX_p!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.dX_p!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Change in environmental resource abundance, simulating a chemostat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L366-L368">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.functional_response-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.functional_response-Tuple{ComponentArrays.ComponentArray, ComponentArrays.ComponentArray, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.functional_response</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">functional_response(
    du::ComponentArray,
    u::ComponentArray,
    p::AbstractParamCollection,
    t::Real
    )::Float64</code></pre><p>Compute scaled functional response <code>f_X</code>, assuming a Holling Type II relationship.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L34-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.individual_variability!-Tuple{DEBBase.ParamStructs.AbstractParams, DEBBase.ParamStructs.AbstractParams}" href="#DEBBase.DEBODE.individual_variability!-Tuple{DEBBase.ParamStructs.AbstractParams, DEBBase.ParamStructs.AbstractParams}"><code>DEBBase.DEBODE.individual_variability!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">individual_variability!(p::Ref{AbstractParams})</code></pre><p>Induce agent variability in spc parameters via zoom factor <code>Z</code>.  <code>Z</code> is sampled from the corresponding distribution given in <code>p</code> and assumed to represent a ratio between maximum structurel <em>masses</em> (not lengths),  so that the surface area-specific ingestion rate <code>Idot_max_rel</code> scales with <code>Z^(1/3)</code> and parameters which represent masses or energy pools scales with <code>Z</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/paramstructs.jl#L65-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.initialize_statevars-Tuple{DEBBase.ParamStructs.AbstractParamCollection}" href="#DEBBase.DEBODE.initialize_statevars-Tuple{DEBBase.ParamStructs.AbstractParamCollection}"><code>DEBBase.DEBODE.initialize_statevars</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize_statevars(p::AbstractParamCollection, pindt::ComponentVector{Float64})::ComponentArray</code></pre><p>For initialization of ODE simulator, initialize the component vector of state variables, <code>u</code>, based on common oaraeter collection <code>theta</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/statevars.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.k_J!-Tuple{DEBBase.ParamStructs.AbstractSpeciesParams}" href="#DEBBase.DEBODE.k_J!-Tuple{DEBBase.ParamStructs.AbstractSpeciesParams}"><code>DEBBase.DEBODE.k_J!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k_J!(spc::AbstractSpeciesParams)::Nothing</code></pre><p>Set the maturity maintenance rate constant,  assuming that the cumulative investment into maturity maintenance  equals the cumulative investment into somatic maintenance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/traits.jl#L17-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.sig-NTuple{4, Float64}" href="#DEBBase.DEBODE.sig-NTuple{4, Float64}"><code>DEBBase.DEBODE.sig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>function sig(     x::Float64,      x<em>thr::Float64,     y</em>left::Float64,      y_right::Float64;      beta::Float64 = 1e16     )::Float6</p><p>Sigmoid switch function.  This can be useful to replace simple if-statements with a continuous function. </p><p><code>y_left</code> and <code>y_right</code> are the function values left and right of the threshold <code>x_thr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L8-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.simulator-Tuple{DEBBase.ParamStructs.AbstractParamCollection}" href="#DEBBase.DEBODE.simulator-Tuple{DEBBase.ParamStructs.AbstractParamCollection}"><code>DEBBase.DEBODE.simulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>simulator(     p::AbstractParamCollection;      model = DEBODE!,     alg = Tsit5(),     saveat = 1,     reltol = 1e-6,     AgentParamType::DataType = ODEAgentParams,     kwargs...)::DataFrame</p><p>Run an ODE-based model. </p><p><strong>args</strong>:</p><ul><li><code>theta::AbstractParamCollection</code>: A parameter collection with defined global parameters (<code>&lt;: AbstractGlobalParams</code>) and species parameters (<code>&lt;: AbstractSpeciesParams</code>).</li></ul><p><strong>kwargs</strong>:</p><ul><li><code>model = DEBODE!</code>: Definition of the derivatives. A function form <code>du!(du, u, p, t)::Nothing</code>. See definition of <code>DEBODE!</code> in <code>derivatives.jl</code> for an example, or see docs and examples of <a href="https://docs.sciml.ai/DiffEqDocs/stable/">DifferentialEquations.jl</a> for more details.</li><li><code>alg = Tsit5()</code>: Algorithm to be used by <code>solve</code> function </li><li><code>saveat = 1</code>: When or how often to save ODE solutions to output</li><li><code>reltol = 1e-6</code>: Relative tolerance of ODE solutions</li><li><code>AgentParamType::DataType = ODEAgentParams</code>: The data type that stores those parameters that are affected by individual variability. There has to be a corresponding constructor so that <code>theta.agn = AgentParamType(theta.spc)</code> works. </li><li><code>kwargs...</code>: Additional keyword argument are passed on to <code>OrdinaryDiffEq.solve</code></li></ul><p><strong>Example</strong>: </p><pre><code class="language-Julia hljs">sim = simulator(DEBParamCollection())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/simulators.jl#L1-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.y_z_DamageAddition!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, Union{DEBBase.ParamStructs.AbstractParamCollection, NamedTuple}, Real}" href="#DEBBase.DEBODE.y_z_DamageAddition!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, Union{DEBBase.ParamStructs.AbstractParamCollection, NamedTuple}, Real}"><code>DEBBase.DEBODE.y_z_DamageAddition!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Response to chemical stressors, assuming damage addition for mixtures. <br/> The PMoA-specific damage values for each stressor are added up,</p><p><span>$D_j = \sum_{z=1}^{n}{D_{j,z}}$</span></p><p>, and the response is caluclated assuming identical DRC parameters for all stressors.  Currently, there are no additional weight factors implemented (assuming that the model is fitted to single-substance data only).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L425-L435">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.y_z_IA!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}" href="#DEBBase.DEBODE.y_z_IA!-Tuple{ComponentArrays.ComponentVector, ComponentArrays.ComponentVector, DEBBase.ParamStructs.AbstractParamCollection, Real}"><code>DEBBase.DEBODE.y_z_IA!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Response to chemical stressors, assuming independent action for mixtures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/derivatives.jl#L404-L406">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DEBODE.@replicates-Tuple{Expr, Int64}" href="#DEBBase.DEBODE.@replicates-Tuple{Expr, Int64}"><code>DEBBase.DEBODE.@replicates</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@replicates(simcall::Expr, nreps::Int64)</code></pre><p>Perform replicated runs of <code>simcall</code>, where <code>simcall</code> is a call to a simulator function. </p><p>Example:</p><pre><code class="nohighlight hljs">spc = SpeciesParams(Z = Truncated(Normal(1, 0.1), 0, Inf)) # initialize default parameters with variable zoom factor
sim = @replicates DEBBase.simulator(DEBParamCollection(spc = spc))) 10 # execute replicated runs to simulator</code></pre><p>In this case, <code>sim</code> will contain the output of 10 replicated simulations. For each replicate, the zoom factor is sampled from a truncated Normal distribution.  <code>sim</code> contains an additional column <code>replicate</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBODE/simulators.jl#L54-L66">source</a></section></article><h2 id="ABC:-Parameter-inference-using-Sequential-Monte-Carlo-Approximate-Bayesian-Computation"><a class="docs-heading-anchor" href="#ABC:-Parameter-inference-using-Sequential-Monte-Carlo-Approximate-Bayesian-Computation">ABC: Parameter inference using Sequential Monte Carlo Approximate Bayesian Computation</a><a id="ABC:-Parameter-inference-using-Sequential-Monte-Carlo-Approximate-Bayesian-Computation-1"></a><a class="docs-heading-anchor-permalink" href="#ABC:-Parameter-inference-using-Sequential-Monte-Carlo-Approximate-Bayesian-Computation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC" href="#DEBBase.ABC"><code>DEBBase.ABC</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Submodule for parameter estimation using approximate bayesian computation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBBase.jl#L83-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.Iterators.zip-Tuple{DEBBase.ABC.Priors}" href="#Base.Iterators.zip-Tuple{DEBBase.ABC.Priors}"><code>Base.Iterators.zip</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zip(priors::Priors)</code></pre><p>Simultaneously iterate over parameter names and prior distributions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L2-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.get-Tuple{DEBBase.ABC.Priors, Symbol}" href="#Base.get-Tuple{DEBBase.ABC.Priors, Symbol}"><code>Base.get</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get(priors::Priors, param::Symbol)</code></pre><p>Get prior distribution from priors object. </p><p><strong>Examples:</strong></p><pre><code class="nohighlight hljs">prior_kM = get(priors, :k_M)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L30-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.rand-Tuple{DataType, DEBBase.ABC.Priors}" href="#Base.rand-Tuple{DataType, DEBBase.ABC.Priors}"><code>Base.rand</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand(defaultparams::DataType, priors::Priors)</code></pre><p>Sample from priors and assign to new instance of default parameter structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/sampling.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.SMC-Tuple{Union{DEBBase.ABC.Priors, Tuple{DEBBase.ABC.Priors, DataFrames.DataFrame}}, Vararg{Any, 4}}" href="#DEBBase.ABC.SMC-Tuple{Union{DEBBase.ABC.Priors, Tuple{DEBBase.ABC.Priors, DataFrames.DataFrame}}, Vararg{Any, 4}}"><code>DEBBase.ABC.SMC</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SMC(
    priors::Union{Priors,Tuple{Priors,DataFrame}},
    defaultparams,
    simulator,
    distance,
    data::Any;
    n_pop::Int64 = 1000,
    q_eps::Float64 = 0.2,
    k_max::Int64 = 3,
    convergence_eps::Float64 = 0.1,
    paralellization_type = threaded,
    savetag = &quot;smc&quot;,
    saveto::Union{String,False} = &quot;&quot;
    )</code></pre><p>kwargs </p><ul><li><code>convergence_eps::Float64</code> : we consider SMC converged if the relative difference between two successive distance thresholds ϵ is less than <code>convergence_eps</code></li><li><code>savedata::Bool</code> : whether to include the value of positional argument <code>data</code> in the output metadata. <code>false</code> by default</li><li><code>saveto::Bool</code> : where to store the <code>SMCResult</code> object on disc. <code>tempname()</code> by default.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L332-L354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.assign!-Tuple{DEBBase.ParamStructs.AbstractParams, Symbol, Float64}" href="#DEBBase.ABC.assign!-Tuple{DEBBase.ParamStructs.AbstractParams, Symbol, Float64}"><code>DEBBase.ABC.assign!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assign!(particle::AbstractParams, paramname::Symbol, value::Float64; assignment_instructions::Nothing)</code></pre><p>Assign a sample to a param struct.  This accounts for the possibility that some parameters might be stored in vectors (e.g. TKTD parameters where each vector element corresponds to a chemical).  If kwarg <code>assignment_instructions</code> is <code>Nothing</code>, we can ignore it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L80-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.assign!-Tuple{DEBBase.ParamStructs.AbstractParams, Union{Vector{String}, Vector{Symbol}}, Union{DataFrames.DataFrameRow, AbstractVector}}" href="#DEBBase.ABC.assign!-Tuple{DEBBase.ParamStructs.AbstractParams, Union{Vector{String}, Vector{Symbol}}, Union{DataFrames.DataFrameRow, AbstractVector}}"><code>DEBBase.ABC.assign!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assign!(particle::AbstractParams, paramnames::Union{Vector{Symbol},Vector{String}}, pvals::Union{AbstractVector,DataFrameRow})</code></pre><p>Assign new values to a parameter structure, given a list of names and values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L99-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.bestfit-Tuple{DEBBase.ParamStructs.AbstractParams, DataFrames.AbstractDataFrame}" href="#DEBBase.ABC.bestfit-Tuple{DEBBase.ParamStructs.AbstractParams, DataFrames.AbstractDataFrame}"><code>DEBBase.ABC.bestfit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bestfit(defparams::AbstractParams, accepted::AbstractDataFrame)</code></pre><p>Get the best fit from <code>accepted</code> (particle with minimum distance) and assign to a copy of <code>defparams</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/sampling.jl#L72-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.calcscale-Tuple{Vector{Float64}}" href="#DEBBase.ABC.calcscale-Tuple{Vector{Float64}}"><code>DEBBase.ABC.calcscale</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate quantile-based parameter scale for scalar parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L109-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.calculatescales-Tuple{Int64, Vector{Symbol}, Vector{Vector{Float64}}}" href="#DEBBase.ABC.calculatescales-Tuple{Int64, Vector{Symbol}, Vector{Vector{Float64}}}"><code>DEBBase.ABC.calculatescales</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate perturbation kernel scales from a Vector of accepted particles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L116-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.calculateweights_threaded-Tuple{Vector{Vector{Float64}}, DEBBase.ABC.Priors, Vector{Symbol}, Vector{Vector{Float64}}, Vector{Int64}, Vector{Float64}, AbstractVector}" href="#DEBBase.ABC.calculateweights_threaded-Tuple{Vector{Vector{Float64}}, DEBBase.ABC.Priors, Vector{Symbol}, Vector{Vector{Float64}}, Vector{Int64}, Vector{Float64}, AbstractVector}"><code>DEBBase.ABC.calculateweights_threaded</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate SMC sampling weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L213-L215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.deflognorm-Tuple{Any, Any}" href="#DEBBase.ABC.deflognorm-Tuple{Any, Any}"><code>DEBBase.ABC.deflognorm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deflognorm(modus, sigma)</code></pre><p>Define a truncated normal distribution based on the mode and σ.  The parameter μ is then calculated as <span>$\mu = ln(mode) + \sigma^2$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/initialization.jl#L18-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.deftruncnorm-Tuple{Any, Any}" href="#DEBBase.ABC.deftruncnorm-Tuple{Any, Any}"><code>DEBBase.ABC.deftruncnorm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deftruncnorm(mu, CV; l = 0, u = Inf)</code></pre><p>Define a truncated normal distribution based on the mean and CV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/initialization.jl#L9-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.extractfields-Tuple{Any}" href="#DEBBase.ABC.extractfields-Tuple{Any}"><code>DEBBase.ABC.extractfields</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Extract fields from a parameter structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/initialization.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.gaussiankernel-NTuple{4, Float64}" href="#DEBBase.ABC.gaussiankernel-NTuple{4, Float64}"><code>DEBBase.ABC.gaussiankernel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gaussiankernel(old_value::Float64, scale::Float64, min::Float64, max::Float64)</code></pre><p>Define a Gaussian perturbation kernel.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L101-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.getfieldname-Tuple{Symbol}" href="#DEBBase.ABC.getfieldname-Tuple{Symbol}"><code>DEBBase.ABC.getfieldname</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getfieldname(paramname::Symbol)::Symbol</code></pre><p>Extract a valid param struct fieldname from a parameter name by dropping the suffix. </p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">getfieldname(:k_D_A_1) # returns :k_D_A</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L71-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.getparindex-Tuple{Symbol}" href="#DEBBase.ABC.getparindex-Tuple{Symbol}"><code>DEBBase.ABC.getparindex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getparindex(paramname::Symbol)::Int64</code></pre><p>Infer index from a parameter name.</p><p><strong>Examples</strong></p><pre><code class="nohighlight hljs">getparindex(:k_D_G_1) # returns 1, because parameter name ends on _1
getparindex(:k_D_G) # will fail, because no index indicated in suffix</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L59-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.iman_conover-Tuple{Any, Any}" href="#DEBBase.ABC.iman_conover-Tuple{Any, Any}"><code>DEBBase.ABC.iman_conover</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iman_conover(ar, cor_mat)</code></pre><p>Induce rank correlations to independent samples, using Iman-Conover algorithm.  This function was adopted from the MCHammer package.  –- **MCHammer was released with the following License statement: **</p><p>Copyright 2019-2021, Technology Partnerz Ltd. and Eric Torkia </p><p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: </p><p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. </p><p>THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/imanconover.jl#L2-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.initialize_threaded-Tuple{Int64, Union{DEBBase.ParamStructs.AbstractParamCollection, DEBBase.ParamStructs.AbstractParams}, DEBBase.ABC.Priors, Any, Any, Any}" href="#DEBBase.ABC.initialize_threaded-Tuple{Int64, Union{DEBBase.ParamStructs.AbstractParamCollection, DEBBase.ParamStructs.AbstractParams}, DEBBase.ABC.Priors, Any, Any, Any}"><code>DEBBase.ABC.initialize_threaded</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>initialize(     n_pop::Int64,      defaultparams::Union{AbstractParams,AbstractParamCollection},      priors::Priors,     simulator,     distance,     data::AbstractDataFrame     )</p><p>Initialization of a population if the priors are purely parameteric priors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L2-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.initialize_threaded-Tuple{Int64, Union{DEBBase.ParamStructs.AbstractParamCollection, DEBBase.ParamStructs.AbstractParams}, Tuple{DEBBase.ABC.Priors, DataFrames.DataFrame}, Any, Any, Any}" href="#DEBBase.ABC.initialize_threaded-Tuple{Int64, Union{DEBBase.ParamStructs.AbstractParamCollection, DEBBase.ParamStructs.AbstractParams}, Tuple{DEBBase.ABC.Priors, DataFrames.DataFrame}, Any, Any, Any}"><code>DEBBase.ABC.initialize_threaded</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initialize(
    n_pop::Int64, 
    defaultparams::AbstractParams, 
    priors::Tuple{Priors,DataFrame},
    simulator,
    distance,
    data::AbstractDataFrame
)</code></pre><p>Initialization of the SMC population if the given priors are a combination of parameteric priors and previously accepted particles. <br/>Note that parameteric prior distributions should always be given for all parameters.  For the parameters which also appear in the dataframe of accepted values</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L37-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.isvecparam-Tuple{Symbol, DEBBase.ParamStructs.AbstractParams}" href="#DEBBase.ABC.isvecparam-Tuple{Symbol, DEBBase.ParamStructs.AbstractParams}"><code>DEBBase.ABC.isvecparam</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isvecparam(paramname::Symbol, particle::AbstractParams)::Bool</code></pre><p>Check whether parameter represents a Vector element.  We assume that the indices of such parameters are indicated by a suffix following the form  <code>param_i</code>. E.g. <code>k_D_G_1</code> for the first value in the vector of <code>k_D_G</code>-values.  <code>isvecparam</code> checks whether such a field occurs in <code>AbstractParams</code> and whether it is a subtype of <code>AbstractVector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L43-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.posterior_sample!-Tuple{DEBBase.ParamStructs.AbstractParams, DataFrames.DataFrame}" href="#DEBBase.ABC.posterior_sample!-Tuple{DEBBase.ParamStructs.AbstractParams, DataFrames.DataFrame}"><code>DEBBase.ABC.posterior_sample!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Take posterior sample from a data frame of accepted values and assign to parameter structure.  ID cols are at the end of the data frame and will be omitted from the sample, according to <code>num_idcols</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/sampling.jl#L48-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.posterior_sample-Tuple{DataFrames.DataFrame}" href="#DEBBase.ABC.posterior_sample-Tuple{DataFrames.DataFrame}"><code>DEBBase.ABC.posterior_sample</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">posterior_sample(accepted::DataFrame; reserved_colnames::Vector{String} = [&quot;distance&quot;, &quot;weight&quot;, &quot;model&quot;, &quot;chain&quot;])</code></pre><p>Take posterior sample from a data frame of accepted values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/sampling.jl#L36-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.ppc-Tuple{DEBBase.ABC.SMCResult}" href="#DEBBase.ABC.ppc-Tuple{DEBBase.ABC.SMCResult}"><code>DEBBase.ABC.ppc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ppc(fit::SMCResult; n_samples = 1000, kwargs...)</code></pre><p>Run a posterior predictive check, given SMCResult object <code>fit</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/evaluation.jl#L125-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.ppc-Tuple{Union{DEBBase.ParamStructs.AbstractParamCollection, DEBBase.ParamStructs.AbstractParams}, Any, DataFrames.AbstractDataFrame, DEBBase.ABC.Priors}" href="#DEBBase.ABC.ppc-Tuple{Union{DEBBase.ParamStructs.AbstractParamCollection, DEBBase.ParamStructs.AbstractParams}, Any, DataFrames.AbstractDataFrame, DEBBase.ABC.Priors}"><code>DEBBase.ABC.ppc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ppc(defaultparams::AbstractParams, simulator, accepted::AbstractDataFrame, priors::Priors; n_samples = 1000)</code></pre><p>Compute posterior predictions for posterior predictive check.</p><ul><li><code>defaultparam::AbstractParams</code>: default parameters used in simulator</li><li><code>simulator</code>: simulator function with signature <code>simulator(defaultparams, priors.params, sample)</code>, where </li><li><code>accepted::AbstractDataFrame</code>: accepted particles as returned by SMC</li></ul><p>This function assumes that <code>simulator</code> returns a <code>DataFrame</code>.</p><p>kwargs</p><ul><li><code>n_samples = 1000</code>: number of samples from <code>accepted_particles</code> to evaluate</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/evaluation.jl#L94-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.pvec-Union{Tuple{P}, Tuple{Vector{P}, Symbol}} where P&lt;:DEBBase.ParamStructs.AbstractParams" href="#DEBBase.ABC.pvec-Union{Tuple{P}, Tuple{Vector{P}, Symbol}} where P&lt;:DEBBase.ParamStructs.AbstractParams"><code>DEBBase.ABC.pvec</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Given parameter <code>param</code>, convert vector of parameter structures containg <code>param</code> into vector of values of <code>param</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/paramhandling.jl#L10-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.rand!-Tuple{DEBBase.ParamStructs.AbstractParams, DEBBase.ABC.Priors}" href="#DEBBase.ABC.rand!-Tuple{DEBBase.ParamStructs.AbstractParams, DEBBase.ABC.Priors}"><code>DEBBase.ABC.rand!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sample from priors and assign to existing instance of parameter structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/sampling.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.resample-Tuple{Vector{Vector{Float64}}, Vector{Float64}, Vector{Float64}, DEBBase.ABC.Priors, Int64, Vector{Symbol}, Int64}" href="#DEBBase.ABC.resample-Tuple{Vector{Vector{Float64}}, Vector{Float64}, Vector{Float64}, DEBBase.ABC.Priors, Int64, Vector{Symbol}, Int64}"><code>DEBBase.ABC.resample</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">resample(
    accepted_particles::Vector{Vector{Float64}}, 
    accepted_distances::Vector{Float64},
    accepted_weights::Vector{Float64},
    priors::Priors,
    n_pop::Int64,
    parnames::Vector{Symbol},
    num_params::Int64
    )</code></pre><p>Resample from previously accepted particles, with account for SMC sampling weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/smc.jl#L143-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.summarize_accepted-Tuple{D} where D&lt;:DataFrames.AbstractDataFrame" href="#DEBBase.ABC.summarize_accepted-Tuple{D} where D&lt;:DataFrames.AbstractDataFrame"><code>DEBBase.ABC.summarize_accepted</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">summarize_accepted(
    accepted::D; 
    ffun = fround
    ) where D &lt;: AbstractDataFrame</code></pre><p>Compute summary statistics from a data frame of accepted particles.  Values are formatted using function <span>$ffun$</span>. </p><p>Use <span>$ffun = x -&gt; x$</span> to suppress any kind of formatting.  By default, values are rounded to 2 significant digits and formatted as strings using <code>fround</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/evaluation.jl#L40-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.wkde-Tuple{DataFrames.DataFrame, Symbol}" href="#DEBBase.ABC.wkde-Tuple{DataFrames.DataFrame, Symbol}"><code>DEBBase.ABC.wkde</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function wkde(accepted::DataFrame, param::Symbol)</code></pre><p>Compute a weighted kernel density estimate for parameter <code>param</code> in accepted particles <code>accepted</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/evaluation.jl#L11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.wkde-Union{Tuple{Matrix{R}}, Tuple{R}, Tuple{Matrix{R}, Any}} where R&lt;:Real" href="#DEBBase.ABC.wkde-Union{Tuple{Matrix{R}}, Tuple{R}, Tuple{Matrix{R}, Any}} where R&lt;:Real"><code>DEBBase.ABC.wkde</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function wkde(X::Matrix{R}, ω = Vector{R}) where R &lt;: Real</code></pre><p>Compute a weighted kernel density estimate on Matrix <code>X</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/evaluation.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.ABC.wkde-Union{Tuple{Vector{R}}, Tuple{R}, Tuple{Vector{R}, Any}} where R&lt;:Real" href="#DEBBase.ABC.wkde-Union{Tuple{Vector{R}}, Tuple{R}, Tuple{Vector{R}, Any}} where R&lt;:Real"><code>DEBBase.ABC.wkde</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wkde(X::Vector{R}, ω = Vector{R}) where R &lt;: Real</code></pre><p>Compute a weighted Kernel Density Estimate of values in <code>X</code> with weights <code>ω</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/ABC/evaluation.jl#L1-L5">source</a></section></article><h2 id="DoseResponse:-A-collection-of-Dose-Response-functions"><a class="docs-heading-anchor" href="#DoseResponse:-A-collection-of-Dose-Response-functions">DoseResponse: A collection of Dose-Response functions</a><a id="DoseResponse:-A-collection-of-Dose-Response-functions-1"></a><a class="docs-heading-anchor-permalink" href="#DoseResponse:-A-collection-of-Dose-Response-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS4-Tuple{Float64, NTuple{4, Float64}}" href="#DEBBase.DoseResponse.CRS4-Tuple{Float64, NTuple{4, Float64}}"><code>DEBBase.DoseResponse.CRS4</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>4-parameter CRS model. Lower limit and response in the control are fixed to 0 and 1, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L119-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS4U-Tuple{Float64, NTuple{4, Float64}}" href="#DEBBase.DoseResponse.CRS4U-Tuple{Float64, NTuple{4, Float64}}"><code>DEBBase.DoseResponse.CRS4U</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>4-parameter CRS model transformed to u-shape, where the response in the control is 1, the lower limit is 0 and the maximum is 2.0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS5US-Tuple{Float64, NTuple{5, Float64}}" href="#DEBBase.DoseResponse.CRS5US-Tuple{Float64, NTuple{5, Float64}}"><code>DEBBase.DoseResponse.CRS5US</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Re-scaled U-shaped CRS model with parameter C fixed to 0. <br/>Parameters are <br/>- alpha: rate of hormetic increase</p><ul><li>b: slope of the inclining part of the curve</li><li>d: maximum stress </li><li>e: inflection point of the inclining part of the curve</li><li>f: hormesis parameter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L144-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS5US-Tuple{Vector{Float64}, NTuple{5, Float64}}" href="#DEBBase.DoseResponse.CRS5US-Tuple{Vector{Float64}, NTuple{5, Float64}}"><code>DEBBase.DoseResponse.CRS5US</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L157">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS6-Tuple{Float64, NTuple{6, Float64}}" href="#DEBBase.DoseResponse.CRS6-Tuple{Float64, NTuple{6, Float64}}"><code>DEBBase.DoseResponse.CRS6</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Cedergreend-Ritz-Streibig model. <br/>Parameters are <br/>- p[1] = α = rate of hormetic increase</p><ul><li>p[2] = b = quasi-slope</li><li>p[3] = c = lower limit</li><li>p[4] = d = response in the control</li><li>p[5] = e = inflection point</li><li>p[6] = f = hormesis parameter</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L107-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS6U-Tuple{Float64, NTuple{6, Float64}}" href="#DEBBase.DoseResponse.CRS6U-Tuple{Float64, NTuple{6, Float64}}"><code>DEBBase.DoseResponse.CRS6U</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>6-parameter U-shaped CRS model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.CRS6US-Tuple{Float64, NTuple{6, Float64}}" href="#DEBBase.DoseResponse.CRS6US-Tuple{Float64, NTuple{6, Float64}}"><code>DEBBase.DoseResponse.CRS6US</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Re-scaled 6-parameter U-shaped CRS model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LL2-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.LL2-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.LL2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Two-parameter log-logistic function.  The expression <code>y = 1 / (1 + (x/p[1])^p[2])</code> is extended to  <code>y = (1 / (1 + Complex(x/p[1])^p[2])).re</code>.  This way we deal with domain errors which might occur if <code>x</code> or <code>p[1]</code> temporarily takes a negative value.  Negative values should theoretically be impossible, but very small values of <code>x</code> (<code>&lt;= 1e-20</code>) might occur during ODE solving.  In this case, the returned real part of the expression evaluates to 1, which is in turn the expected behaviour.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L2-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LL2M-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.LL2M-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.LL2M</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Two-parameter log-logistic function transformed to increasing function  for application to PMoA maintenance costs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L25-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LL2M-Tuple{Vector{Float64}, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.LL2M-Tuple{Vector{Float64}, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.LL2M</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LL2h-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.LL2h-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.LL2h</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Cumulative hazard function of the log-logistic distribution. Mainly used for application in GUTS.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L14-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LL2hinv-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.LL2hinv-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.LL2hinv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Inverse of the cumulative hazard two-parameter log-logistic function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L47-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LL2inv-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.LL2inv-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.LL2inv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Inverse of the two-parameter log-logistic function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L40-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LLAS3-Tuple{Float64, Tuple{Float64, Float64, Float64}}" href="#DEBBase.DoseResponse.LLAS3-Tuple{Float64, Tuple{Float64, Float64, Float64}}"><code>DEBBase.DoseResponse.LLAS3</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Asymmetric log-logistic function with additional slope parameter. Arguments:     - <code>p1</code> = EC50     - <code>p2</code> = beta     - <code>p3</code> = beta_2</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L87-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.LLBP5-Tuple{Float64, NTuple{5, Float64}}" href="#DEBBase.DoseResponse.LLBP5-Tuple{Float64, NTuple{5, Float64}}"><code>DEBBase.DoseResponse.LLBP5</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Bi-phasic log-logistic function, where each phase is described by a two-parameter log-logistic function.  Requires additional &quot;breakpoint&quot; parameter. Arguments:     - <code>p1</code> = EC50<em>1     - <code>p2</code> = beta</em>1     - <code>p3</code> = EC50<em>2     - <code>p4</code> = beta</em>2     - <code>p5</code> = breakpoint = relative response at which second phase starts</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L65-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.NEC2neg-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.NEC2neg-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.NEC2neg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Decreasing NEC model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L176-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.NEC2pos-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.NEC2pos-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.NEC2pos</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Increasing NEC model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L170-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.WB2-Tuple{Float64, Tuple{Float64, Float64}}" href="#DEBBase.DoseResponse.WB2-Tuple{Float64, Tuple{Float64, Float64}}"><code>DEBBase.DoseResponse.WB2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Two-parameter Weibull function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L54-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.DoseResponse.contmax-Tuple{Any, Any}" href="#DEBBase.DoseResponse.contmax-Tuple{Any, Any}"><code>DEBBase.DoseResponse.contmax</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Continuous maximum function, using a sigmoid function to determine the maximum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DoseResponse/doseresponse.jl#L165-L167">source</a></section></article><h2 id="Figures:-Recipes-and-utilities-for-plotting-model-output"><a class="docs-heading-anchor" href="#Figures:-Recipes-and-utilities-for-plotting-model-output">Figures: Recipes and utilities for plotting model output</a><a id="Figures:-Recipes-and-utilities-for-plotting-model-output-1"></a><a class="docs-heading-anchor-permalink" href="#Figures:-Recipes-and-utilities-for-plotting-model-output" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Figures" href="#DEBBase.Figures"><code>DEBBase.Figures</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Recipes and convenience functions for plotting model output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/DEBBase.jl#L125-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Figures.gridxattr-Tuple{Any, Any, Int64, Int64}" href="#DEBBase.Figures.gridxattr-Tuple{Any, Any, Int64, Int64}"><code>DEBBase.Figures.gridxattr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gridxattr(attr, nullattr, numrows::Int64, numcols::Int64)::Matrix{String}</code></pre><p>Analogous to <code>gridyattr</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Figures/figutils.jl#L45-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Figures.gridyattr-Tuple{Any, Any, Int64, Int64}" href="#DEBBase.Figures.gridyattr-Tuple{Any, Any, Int64, Int64}"><code>DEBBase.Figures.gridyattr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assign some attribute value <code>attr</code> to the left-most column of a multi-plot and  another attribute value <code>nullattr</code> to  all other subplots.</p><p>Example:</p><pre><code class="language-Julia hljs">using Plots, Plots.Measures
# sets the left left column margin to 2.5mm and the other ones to 0mm
plot(plot(), plot(), plot(), leftmargin = gridyattr(2.5mm, 0mm, 1, 3), layout = (1,3)) </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Figures/figutils.jl#L23-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Figures.gridylabel-Tuple{AbstractString, Int64, Int64}" href="#DEBBase.Figures.gridylabel-Tuple{AbstractString, Int64, Int64}"><code>DEBBase.Figures.gridylabel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create shared y-labels for plot with grid layout, placing labels only on the left-most subplots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Figures/figutils.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Figures.saveplt-Tuple{Any, Any}" href="#DEBBase.Figures.saveplt-Tuple{Any, Any}"><code>DEBBase.Figures.saveplt</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Save plot plt with name, assuming known global TAG and plotsdir.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Figures/figutils.jl#L61-L63">source</a></section></article><h2 id="ParamStructs:-Infrastructure-to-organize-parameter-structures"><a class="docs-heading-anchor" href="#ParamStructs:-Infrastructure-to-organize-parameter-structures">ParamStructs: Infrastructure to organize parameter structures</a><a id="ParamStructs:-Infrastructure-to-organize-parameter-structures-1"></a><a class="docs-heading-anchor-permalink" href="#ParamStructs:-Infrastructure-to-organize-parameter-structures" title="Permalink"></a></h2><p>By default, DEBBase uses mutable structs to store parameters. &lt;br&gt;</p><h2 id="Utils:-Other-utility-functions"><a class="docs-heading-anchor" href="#Utils:-Other-utility-functions">Utils: Other utility functions</a><a id="Utils:-Other-utility-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utils:-Other-utility-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.diffvec-Tuple{AbstractVector}" href="#DEBBase.Utils.diffvec-Tuple{AbstractVector}"><code>DEBBase.Utils.diffvec</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">diffvec(x::AbstractVector)</code></pre><p>Calculate difference along a vector, inserting NaN as first element (analogous to Pandas&#39; diff method).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.drop_na!-Tuple{DataFrames.DataFrame}" href="#DEBBase.Utils.drop_na!-Tuple{DataFrames.DataFrame}"><code>DEBBase.Utils.drop_na!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drop_na!(df::DataFrame)::Nothing</code></pre><p>Mutating version of drop_na</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L79-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.drop_na-Tuple{DataFrames.AbstractDataFrame}" href="#DEBBase.Utils.drop_na-Tuple{DataFrames.AbstractDataFrame}"><code>DEBBase.Utils.drop_na</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drop_na(df::AbstractDataFrame; verbose=false)::DataFrame</code></pre><p>Drop all rows with missing values from data frame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L64-L68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.extract_colnames-Tuple{ComponentArrays.ComponentVector}" href="#DEBBase.Utils.extract_colnames-Tuple{ComponentArrays.ComponentVector}"><code>DEBBase.Utils.extract_colnames</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_colnames(u::ComponentVector)</code></pre><p>Extract the column names of an output dataframe from an ODE solution object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/ioutils.jl#L9-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.extract_colnames-Tuple{SciMLBase.ODESolution}" href="#DEBBase.Utils.extract_colnames-Tuple{SciMLBase.ODESolution}"><code>DEBBase.Utils.extract_colnames</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_colnames(sol::O)::Vector{Symbol} where {O &lt;:ODESolution}</code></pre><p>Extract the column names of an output dataframe from an ODE solution object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/ioutils.jl#L21-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.fround-Tuple{Any}" href="#DEBBase.Utils.fround-Tuple{Any}"><code>DEBBase.Utils.fround</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fround(x; sigdigits=2)</code></pre><p>Formatted rounding to significant digits (omitting decimal point when appropriate).  Returns rounded number as string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L48-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.geomrange-Tuple{Real, Real}" href="#DEBBase.Utils.geomrange-Tuple{Real, Real}"><code>DEBBase.Utils.geomrange</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">geomrange(a::Real, b::Real; length=50)</code></pre><p>Geometric series created from two extreme values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.geomrange-Tuple{Vector{Float64}}" href="#DEBBase.Utils.geomrange-Tuple{Vector{Float64}}"><code>DEBBase.Utils.geomrange</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">geomrange(v::Vector{Float64}; length=50)</code></pre><p>Geometric series created from range of values within a vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L27-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.get_treatment_names-Tuple{Vector{Vector{Float64}}, Vector{Symbol}}" href="#DEBBase.Utils.get_treatment_names-Tuple{Vector{Vector{Float64}}, Vector{Symbol}}"><code>DEBBase.Utils.get_treatment_names</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_treatment_names(exposure::Vector{Vector{Float64}}, stressor_names::Array{Symbol,1})</code></pre><p>Infer treatment types (categorical), levels (ordinal) and names (type + level) from Array of exposure concentrations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.getstat-Tuple{DataFrames.DataFrame, String}" href="#DEBBase.Utils.getstat-Tuple{DataFrames.DataFrame, String}"><code>DEBBase.Utils.getstat</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getstat(data::Vector{DataFrame}, statistic::String)</code></pre><p>Retrieve the mean of a statistic from a data frame with columns  &quot;statistic&quot; (listing different kinds of summary statistics) and &quot;value&quot;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/inputprocessing.jl#L145-L150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.idcol!-Tuple{Any, Symbol, Any}" href="#DEBBase.Utils.idcol!-Tuple{Any, Symbol, Any}"><code>DEBBase.Utils.idcol!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">idcol!(sim::Any, col::Symbol, val)</code></pre><p>Add identifier column to a results object <code>sim</code>, assuming that <code>sim</code> is some collection of <code>DataFrame</code>s (e.g. Tuple, Vector).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/outputprocessing.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.idcol!-Tuple{DataFrames.AbstractDataFrame, Symbol, Any}" href="#DEBBase.Utils.idcol!-Tuple{DataFrames.AbstractDataFrame, Symbol, Any}"><code>DEBBase.Utils.idcol!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">idcol!(sim::AbstractDataFrame, col::Symbol, val)</code></pre><p>Add identifier column with name <code>col</code> and value <code>val</code> to results DataFrame <code>sim</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/outputprocessing.jl#L93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.into!-Tuple{DEBBase.ParamStructs.AbstractParams, DEBBase.ParamStructs.AbstractParams}" href="#DEBBase.Utils.into!-Tuple{DEBBase.ParamStructs.AbstractParams, DEBBase.ParamStructs.AbstractParams}"><code>DEBBase.Utils.into!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">into!(sink::AbstractParams, source::AbstractParams)::Nothing</code></pre><p>Put values from <code>source</code> into <code>sink</code>. </p><ul><li><code>source::AbstractParams</code>: A param struct from which we want to extract all parameters.</li><li><code>sink::AbstractParams</code>: All values from <code>sink</code> will be assigned to corresponding fields of <code>sink</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/inputprocessing.jl#L27-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.into-Tuple{DataType, DEBBase.ParamStructs.AbstractParams}" href="#DEBBase.Utils.into-Tuple{DataType, DEBBase.ParamStructs.AbstractParams}"><code>DEBBase.Utils.into</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">into!(sink::AbstractParams, source::AbstractParams)</code></pre><p>Put values from <code>source</code> into <code>sink</code>. </p><ul><li><code>source::AbstractParams</code>: A param struct from which we want to extract all parameters.</li><li><code>Sink::DataType</code>: All values from <code>sink</code> will be assigned to a new instance of type <code>Sink</code>, assuming that a constructor <code>Sink()</code> exists.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/inputprocessing.jl#L52-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.ismin-Union{Tuple{Vector{R}}, Tuple{R}} where R&lt;:Real" href="#DEBBase.Utils.ismin-Union{Tuple{Vector{R}}, Tuple{R}} where R&lt;:Real"><code>DEBBase.Utils.ismin</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get positions of minimum values as BitVector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L206-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.isolate_pmoas-Tuple{DEBBase.ParamStructs.AbstractParams, Vector{String}, Int64}" href="#DEBBase.Utils.isolate_pmoas-Tuple{DEBBase.ParamStructs.AbstractParams, Vector{String}, Int64}"><code>DEBBase.Utils.isolate_pmoas</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isolate_pmoas(spc::AbstractParams, pmoas::Vector{String}, z::Int64)::AbstractParams</code></pre><p>Isolate the indicated PMoAs for chemical stressor <code>z</code>.  That means, turn off all PMoAs (including lethal effects <code>h</code>) except for those indicated in <code>pmoas</code>-Vector.  This is done through the toxicokinetic rate constant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/inputprocessing.jl#L104-L110">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.lab-Union{Tuple{Vector{R}}, Tuple{R}} where R&lt;:Real" href="#DEBBase.Utils.lab-Union{Tuple{Vector{R}}, Tuple{R}} where R&lt;:Real"><code>DEBBase.Utils.lab</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lab(v::Vector{R}; kwargs...) where R &lt;: Real</code></pre><p>Create legend labels from Vector of numeric Values.  Kwargs are handed down to fround. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L138-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.read_W3C-Tuple{AbstractString}" href="#DEBBase.Utils.read_W3C-Tuple{AbstractString}"><code>DEBBase.Utils.read_W3C</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_W3C(file_path::AbstractString; kwargs...)::DataFrame</code></pre><p>Read a csv including W3C-formatted metadata. Each line with metadata starts with a hashtag (<code>#</code>). For example:</p><pre><code class="nohighlight hljs">#t: time in days
#W: wet weight in grams

t,W
0,0.1
1,0.2
2,0.3</code></pre><p>Additional kwargs are handed down to <code>CSV.File</code>. The function currently returns just the core data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L164-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.relative_response-Union{Tuple{D}, Tuple{D, Vector{Symbol}, Symbol}} where D&lt;:DataFrames.AbstractDataFrame" href="#DEBBase.Utils.relative_response-Union{Tuple{D}, Tuple{D, Vector{Symbol}, Symbol}} where D&lt;:DataFrames.AbstractDataFrame"><code>DEBBase.Utils.relative_response</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate the relative responses. </p><p>Positional arguments: </p><ul><li><code>sim::AbstractDataFrame</code>: results</li><li><code>response_vars::Vector{Symbol}</code>: response variables for which to calculate the relative responses</li><li><code>treatment_var::Symbol</code>: Column indicating the treatment. Column values can be numerical or categorical, but <code>identify_control</code> kwarg has to be specified in the latter case</li></ul><p>Keyword arguments: </p><ul><li><code>groupby_vars::Vector{Symbol}</code>: relative response will be conditioned on these variables (e.g. time, separate experiments...). Empty by default.</li><li><code>identify_control</code>: function used to identify reference values from <code>treatment_var</code>. By default, this is <code>minimum()</code> (assuming that column values in <code>treatment_var</code> are numerical).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/outputprocessing.jl#L47-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.replace_na!-Tuple{DataFrames.AbstractDataFrame, Vector{Symbol}}" href="#DEBBase.Utils.replace_na!-Tuple{DataFrames.AbstractDataFrame, Vector{Symbol}}"><code>DEBBase.Utils.replace_na!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">replace_na!(
    df::AbstractDataFrame,
    cols::Vector{Symbol};
    replace_val = 0.0
    )</code></pre><p>Replace all missing values in DataFrame with <code>replace_val</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L90-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.rr-Union{Tuple{R}, Tuple{R, R}} where R&lt;:Real" href="#DEBBase.Utils.rr-Union{Tuple{R}, Tuple{R, R}} where R&lt;:Real"><code>DEBBase.Utils.rr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate relative response, given scalar values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/outputprocessing.jl#L22-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.set_equal!-Union{Tuple{SS}, Tuple{DEBBase.ParamStructs.AbstractParams, SS, SS}} where SS&lt;:Union{String, Symbol}" href="#DEBBase.Utils.set_equal!-Union{Tuple{SS}, Tuple{DEBBase.ParamStructs.AbstractParams, SS, SS}} where SS&lt;:Union{String, Symbol}"><code>DEBBase.Utils.set_equal!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Set parameters with common prefix to the value of a reference parameter.  E.g. </p><pre><code class="nohighlight hljs">set_equal!(spc, :Idot_max_rel, :lrv)</code></pre><p>sets all parameters whose names start with <code>Idot_max_rel</code> equal to <code>Idot_max_rel_lrv</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/inputprocessing.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.skipinf-Tuple{Array}" href="#DEBBase.Utils.skipinf-Tuple{Array}"><code>DEBBase.Utils.skipinf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Skip inifite values. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L2-L4">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.sol_to_df-Tuple{O} where O&lt;:SciMLBase.ODESolution" href="#DEBBase.Utils.sol_to_df-Tuple{O} where O&lt;:SciMLBase.ODESolution"><code>DEBBase.Utils.sol_to_df</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert ODE solution object to output data frame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/outputprocessing.jl#L11-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.sol_to_mat-Tuple{O} where O&lt;:SciMLBase.ODESolution" href="#DEBBase.Utils.sol_to_mat-Tuple{O} where O&lt;:SciMLBase.ODESolution"><code>DEBBase.Utils.sol_to_mat</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sol_to_mat(sol::O)::Matrix{Float64}</code></pre><p>Convert ODE solution object to matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/outputprocessing.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.trim!-Tuple{DEBBase.ParamStructs.AbstractParams}" href="#DEBBase.Utils.trim!-Tuple{DEBBase.ParamStructs.AbstractParams}"><code>DEBBase.Utils.trim!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trim!(spc::AbstractParams)</code></pre><p>Trim TKTD parameters to the smallest number of stressors indicated for any PMoA. For example <code>k_D_G = [1., 0.], k_D_M = [1.]</code> will be trimmed to <code>k_D_G = [1.], k_D_M = [1.]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/inputprocessing.jl#L68-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.vectify-Tuple{Any}" href="#DEBBase.Utils.vectify-Tuple{Any}"><code>DEBBase.Utils.vectify</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parse String to Vector of Floats.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L7-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.which_in-Tuple{String, Vector{String}}" href="#DEBBase.Utils.which_in-Tuple{String, Vector{String}}"><code>DEBBase.Utils.which_in</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Identify element of <code>possibilities</code> occuring in <code>x</code>. <br/>E.g., which_in(&quot;I like apples&quot;, [&quot;apples&quot;, &quot;bananas&quot;]) returns &quot;apples&quot;. <br/>If multiple possibilities occur, first detection is returned. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DEBBase.Utils.wrappend-Tuple{String, DataFrames.DataFrame, Int64}" href="#DEBBase.Utils.wrappend-Tuple{String, DataFrames.DataFrame, Int64}"><code>DEBBase.Utils.wrappend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wrappend(file::String, data::DataFrame, step::Int64)</code></pre><p>Write DataFrames to disc during loop. Will overwrite existing file if step == 1 and append if step &gt; 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonHansul/DEBBase.jl/blob/303cba70752b256aad4e1861b73be58c4c53d819/src/Utils/utils.jl#L148-L152">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Monday 16 September 2024 18:21">Monday 16 September 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
